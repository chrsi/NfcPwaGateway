<html>
  <head>
    <title>PWA Gateway</title>
  </head>
  <body>
    <a id="redirectUrl">Redirect</a>
    <span id="redirectHint"></span>
    <script lang="javascript">
        const queryString = window.location.search.substr(1);
        const queryParams = queryString.split('&');
  
        const params = [];
        queryParams.forEach(param => {
          var kvPair = param.split('=');
          const paramKey = decodeURIComponent(kvPair[0]);
          const paramValue = decodeURIComponent(kvPair[1]);
          params[paramKey] = paramValue;
        });
  
        pwaLink = document.getElementById("redirectUrl");
        pwaLink.href= params["pwa"];

        const hostRegex = /(https|http):\/\/(.*?)(:|\/)/;
        const host = params["pwa"].match(hostRegex);

        const redirectHint = document.getElementById("redirectHint");
        redirectHint.textContent = `Click here to redirect to ${host}`;

        const body = document.getElementsByTagName('body')[0];
        body.onclick = () => {
          pwaLink.click();
          window.close();          
        }
      </script>
  </body>
</html>
